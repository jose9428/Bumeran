
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <title>Postulante</title>
        <link rel="stylesheet" href="vendors/ti-icons/css/themify-icons.css">
        <link rel="stylesheet" href="vendors/base/vendor.bundle.base.css">
        <link rel="stylesheet" href="css/style.css">
        <link rel="shortcut icon" href="https://www.bumeran.com.pe/candidate/static/media/bumeran.296e6bc2.svg" />
    </head>
    <body>
        <div id="app">
            <div class="container-scroller">
                <navbar></navbar>
                <div class="container-fluid page-body-wrapper">
                    <sidebar></sidebar>

                    <div class="main-panel">
                        <div class="content-wrapper">
                            <div class="card">
                                <div class="card-body">
                                    <h4 class="card-title">Postulantes</h4>
                                    <div class="template-demo"> 
                                        <button @click="Nuevo()" class="btn btn-success btn-sm btn-rounded" data-toggle="modal" data-target="#modalPostulante" >Postular Aqui</button>
                                        <br>  <br>
                                    </div>
                                    <div class="col-md-12 grid-margin stretch-card" v-for="item in postulantes"  v-if="postulantes.length > 0" >
                                        <div class="card">
                                            <div class="card-body">
                                                <div class="row">
                                                    <div class="col-sm-2">
                                                        <img v-if="item.genero =='Femenino'" src="img/mujer.jpg" style="width: 100px; height: 90px;"/>
                                                        <img v-if="item.genero !='Femenino'" src="img/hombre.jpg" style="width: 100px; height: 90px;"/>

                                                        <button @click="VerDetalle(item)" class="btn btn-sm btn-rounded btn-primary mt-3">Ver postulación</button>
                                                    </div>
                                                    <div class="col-sm-9">
                                                        <p class="mb-0 mt-2 text-success">Postulante: <span class="text-black ml-1"><small>{{item.nombre +' '+ item.apellido}}</small></span></p>
                                                        <p class="mb-0 mt-2 text-success">Nacionalidad: <span class="text-black ml-1"><small>{{item.fechaNacimiento}} </small></span></p>
                                                        <p class="mb-0 mt-2 text-success">Fecha Nacimiento: <span class="text-black ml-1"><small>{{item.nacionalidad}}</small></span></p>
                                                        <p class="mb-0 mt-2 text-success">Formacion Académica: <span class="text-black ml-1"><small>{{item.foracademica}}</small></span></p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div v-if="postulantes.length == 0" class="alert alert-primary" role="alert">
                                        No hay postulantes registrados.
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>


                    <div class="modal fade" id="modalPostulante" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                        <div class="modal-dialog modal-xl">
                            <div class="modal-content">
                                <div class="modal-header bg-primary text-white">
                                    <h5 class="modal-title"  v-if="postulante.idPostulante == 0" >Nueva Postulación</h5>
                                    <h5 class="modal-title"  v-if="postulante.idPostulante != 0" >Detalle Postulación</h5>
                                </div>
                                <div class="modal-body"> 
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group row">
                                                <label class="col-sm-3 col-form-label">Nombres</label>
                                                <div class="col-sm-9">
                                                    <input type="text" class="form-control" v-model="postulante.nombre" :disabled="postulante.idPostulante != 0"/>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group row">
                                                <label class="col-sm-3 col-form-label">Apellidos</label>
                                                <div class="col-sm-9">
                                                    <input type="text" class="form-control" v-model="postulante.apellido" :disabled="postulante.idPostulante != 0"/>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group row">
                                                <label class="col-sm-3 col-form-label">Nacionalidad</label>
                                                <div class="col-sm-9">
                                                    <input type="text" class="form-control" v-model="postulante.nacionalidad" :disabled="postulante.idPostulante != 0"/>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group row">
                                                <label class="col-sm-3 col-form-label">Fecha Nacimiento</label>
                                                <div class="col-sm-9">
                                                    <input type="date" class="form-control" v-model="postulante.fechaNacimiento" :disabled="postulante.idPostulante != 0"/>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group row">
                                                <label class="col-sm-3 col-form-label">Genero</label>
                                                <div class="col-sm-9">
                                                    <select class="form-control" v-model="postulante.genero" :disabled="postulante.idPostulante != 0">
                                                        <option v-for="item in generos" :value="item" >
                                                            {{item}}
                                                        </option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group row">
                                                <label class="col-sm-3 col-form-label">DNI</label>
                                                <div class="col-sm-9">
                                                    <input type="text" class="form-control" maxlength="8" v-model="postulante.dni" :disabled="postulante.idPostulante != 0"/>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group row">
                                                <label class="col-sm-3 col-form-label">Direccion</label>
                                                <div class="col-sm-9">
                                                    <input type="text" class="form-control" v-model="postulante.direccion" :disabled="postulante.idPostulante != 0"/>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group row">
                                                <label class="col-sm-3 col-form-label">Celular</label>
                                                <div class="col-sm-9">
                                                    <input type="text" class="form-control" maxlength="9" v-model="postulante.celular" :disabled="postulante.idPostulante != 0"/>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group row">
                                                <label class="col-sm-3 col-form-label">Formación Academica</label>
                                                <div class="col-sm-9">
                                                    <input type="text" class="form-control" v-model="postulante.foracademica" :disabled="postulante.idPostulante != 0"/>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group row">
                                                <label class="col-sm-3 col-form-label">Idioma</label>
                                                <div class="col-sm-9">
                                                    <input type="text" class="form-control"  v-model="postulante.idioma" :disabled="postulante.idPostulante != 0"/>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group row">
                                                <label class="col-sm-3 col-form-label">Salario</label>
                                                <div class="col-sm-9">
                                                    <input type="number" class="form-control" v-model="postulante.salario" :disabled="postulante.idPostulante != 0"/>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group row">
                                                <label class="col-sm-3 col-form-label">Experiencia</label>
                                                <div class="col-sm-9">
                                                    <input type="text" class="form-control" v-model="postulante.expericencia" :disabled="postulante.idPostulante != 0"/>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group row">
                                                <label class="col-sm-3 col-form-label">Conocimientos</label>
                                                <div class="col-sm-9">
                                                    <input type="text" class="form-control" v-model="postulante.conocimientos" :disabled="postulante.idPostulante != 0"/>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-primary" @click="Guardar()" v-if="postulante.idPostulante == 0">Guardar</button>
                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


        </div>

        <script src="vendors/base/vendor.bundle.base.js"></script>
        <script src="js/off-canvas.js"></script>
        <script src="js/hoverable-collapse.js"></script>
        <script src="js/template.js"></script>
        <script src="js/todolist.js"></script>
        <script src="js/dashboard.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js" ></script>
        <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/vue-resource/1.5.1/vue-resource.js"></script>
        <script src="js/componentes/script.js" type="text/javascript"></script>
    </body>

    <script>
new Vue({
    el: "#app",
    data: {
        urlBase: 'https://localhost:7254/api/Postulante',
        postulantes: [],
        postulante: {},
        generos: ["Femenino", "Masculino"]
    }, mounted: function () {
        this.listPostulantes();
    },
    methods: {
        listPostulantes: function () {
            var url = this.urlBase + "/listar";
            this.$http.get(url).then(function (response) {
                if (response.body.length > 0) {
                    this.postulantes = response.body;
                } else {
                    this.postulantes = [];
                }
            }, error => {
                this.postulantes = [];
            });
        }, Guardar: function () {
            var url = this.urlBase + "/guardar";
            this.$http.post(url, this.postulante).then(function (response) {
                var data = response.body;
                if (data.msj === "OK") {
                    this.CerrarModal();
                    this.listPostulantes();
                    this.Nuevo();
                    alert('La postulación se guardó de forma correcta.');
                } else {
                    alert(data.msj);
                }
            }).catch(error => {
                alert("Lo sentimos ha ocurrido un error interno Status: 500.");
                console.error("A Ocurrido un error", error);
            });
        },
        Nuevo: function () {
            this.postulante = {
                idPostulante: 0,
                nombre: "",
                apellido: "",
                nacionalidad: "",
                fechaNacimiento: "",
                genero: "",
                dni: "",
                direccion: "",
                celular: "",
                foracademica: "",
                idioma: "",
                salario: 0,
                expericencia: "",
                conocimientos: ""
            };
        },
        VerDetalle: function (item) {
            this.postulante = item;
            $('#modalPostulante').modal('show');
        },
        CerrarModal: function () {
            $('#modalPostulante').modal('hide');
        }
    }
});

    </script>
</html>

